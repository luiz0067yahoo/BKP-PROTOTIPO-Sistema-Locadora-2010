<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html class="js gecko firefox3  win" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>



<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">  
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="Java Code Examples from The Java Developers Almanac">
<meta name="keywords" content="Java,examples">
<meta name="owner" content="Patrick Chan">
  <title>Inserting a Row into a Database Table Using a Prepared Statement | Example Depot</title>  
  <link type="text/css" rel="stylesheet" media="all" href="InsertPs_arquivos/views.css">
<link type="text/css" rel="stylesheet" media="all" href="InsertPs_arquivos/css_fcfdc168cda61024973a0d1ae90b2bbc.css">
  <script type="text/javascript" src="InsertPs_arquivos/js_9ab7f0952ed3ddc9ca6375ed49d622d6.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "/" });
//--><!]]>
</script>
  <!--[if IE 6]><link rel="stylesheet" href="/sites/all/themes/artisteer_exd/style.ie6.css" type="text/css" /><![endif]-->  
  <!--[if IE 7]><link rel="stylesheet" href="/sites/all/themes/artisteer_exd/style.ie7.css" type="text/css" media="screen" /><![endif]-->
  <script type="text/javascript">if (Drupal.jsEnabled) {$(document).ready(function(){
				window.setTimeout("artNoStyleAdding(document)", 2000);});}</script>
  <script type="text/javascript"> </script>
</head><body>
<div id="art-main">
<div class="art-Sheet">
    <div class="art-Sheet-tl"></div>
    <div class="art-Sheet-tr"></div>
    <div class="art-Sheet-bl"></div>
    <div class="art-Sheet-br"></div>
    <div class="art-Sheet-tc"></div>
    <div class="art-Sheet-bc"></div>
    <div class="art-Sheet-cl"></div>
    <div class="art-Sheet-cr"></div>
    <div class="art-Sheet-cc"></div>
    <div class="art-Sheet-body">
<div class="art-Header">
    <div class="art-Header-jpeg"></div>
<div class="art-Logo">
    <h1 class="art-Logo-name"><a href="http://www.exampledepot.com/" title="Example Depot">Example Depot</a></h1><div class="art-Logo-text">Useful code samples</div></div>
</div>
<div class="art-nav">
        <div class="l"></div>
    <div class="r"></div>
            <ul class="art-menu">
<li class="leaf first"><a href="http://www.exampledepot.com/" title=""><span class="l"> </span><span class="r"> </span><span class="t">Home</span></a></li><li><span class="art-menu-separator"></span></li>
<li class="leaf"><a href="http://www.exampledepot.com/egs" title=""><span class="l"> </span><span class="r"> </span><span class="t">Java</span></a></li><li><span class="art-menu-separator"></span></li>
<li class="leaf"><a href="http://www.exampledepot.com/contact" title=""><span class="l"> </span><span class="r"> </span><span class="t">Contact</span></a></li><li><span class="art-menu-separator"></span></li>
<li class="leaf last"><a href="http://www.exampledepot.com/blog" title=""><span class="l"> </span><span class="r"> </span><span class="t">Blog</span></a></li>
</ul>
	</div>
<div class="art-contentLayout">
<div class="art-sidebar1"><div class="art-Block clear-block block block-search" id="block-search-0">
    <div class="art-Block-cc"></div>
    <div class="art-Block-body">

	<div class="art-BlockContent content">
	    <div class="art-BlockContent-body">
	
		<form action="/egs/java.sql/InsertPs.html" accept-charset="UTF-8" method="post" id="search-block-form">
<div><div class="form-item" id="edit-search-block-form-1-wrapper">
 <input maxlength="128" name="search_block_form" id="edit-search-block-form-1" size="15" title="Enter the terms you wish to search for." class="form-text" type="text">
</div>
<span class="art-button-wrapper"><span class="l"></span><span class="r"></span><input name="op" id="edit-submit" value="Search" class="form-submit art-button" type="submit"></span><input name="form_build_id" id="form-486a1492a67cd459588cf0fcd34fd746" value="form-486a1492a67cd459588cf0fcd34fd746" type="hidden">
<input name="form_id" id="edit-search-block-form" value="search_block_form" type="hidden">

</div></form>

	    </div>
	</div>
	

    </div>
</div>
<div class="art-Block clear-block block block-adsense_managed" id="block-adsense_managed-0">
    <div class="art-Block-cc"></div>
    <div class="art-Block-body">

	<div class="art-BlockContent content">
	    <div class="art-BlockContent-body">
	
		<div style="text-align: center;"><div class="adsense adsense_managed">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6001183370374757";
/* 160x600 */
google_ad_slot = "6138857183";
google_ad_width = 160;
google_ad_height = 600;
//-->
</script>
<script type="text/javascript" src="InsertPs_arquivos/show_ads.js">
</script><script src="InsertPs_arquivos/expansion_embed.js"></script><script src="InsertPs_arquivos/test_domain.js"></script><script>google_protectAndRun("ads_core.google_render_ad", google_handleError, google_render_ad);</script><ins style="display: inline-table; border: medium none; height: 600px; margin: 0pt; padding: 0pt; position: relative; visibility: visible; width: 160px;"><ins style="display: block; border: medium none; height: 600px; margin: 0pt; padding: 0pt; position: relative; visibility: visible; width: 160px;"><iframe allowtransparency="true" hspace="0" id="google_ads_frame1" marginheight="0" marginwidth="0" name="google_ads_frame" src="InsertPs_arquivos/ads.htm" style="left: 0pt; position: absolute; top: 0pt;" vspace="0" scrolling="no" frameborder="0" height="600" width="160"></iframe></ins></ins>
</div></div>
	    </div>
	</div>
	

    </div>
</div>
</div><div class="art-content">
              
<div class="art-Post">
    <div class="art-Post-body">
<div class="art-Post-inner">
<div class="art-PostContent">
<div class="breadcrumb"><a href="http://www.exampledepot.com/egs">Java</a> » <a href="http://www.exampledepot.com/egs/index.html">Java packages</a> » <a href="http://www.exampledepot.com/egs/java.sql/pkg.html">java.sql</a> » <a href="http://www.exampledepot.com/taxonomy/term/217">Inserting and Updating Data</a></div>
</div>
<div class="cleared"></div>

</div>

    </div>
</div>
<div class="art-Post">
    <div class="art-Post-body">
<div class="art-Post-inner">
<h2 class="art-PostHeader"> <a href="http://www.exampledepot.com/egs/java.sql/InsertPs.html" title="Inserting a Row into a Database Table Using a Prepared Statement">Inserting a Row into a Database Table Using a Prepared Statement</a>
</h2>
<div class="art-PostContent">
<div class="art-article"><!-- google_ad_section_start -->
<div class="exd_ex">
If you have a SQL statement that needs to be executed many times but
with different values, a prepared statement can be used to improve
performance. For example, if you have a website that looks up product
information with a product id using the same query each time, a
prepared statement should be used.  A prepared statement is a
precompiled SQL statement and its use saves the database from
repeatedly having to compile the SQL statement each time it is
executed.

<p> A query in a prepared statement contains placeholders
(represented by the '?'  character) instead of explicit values.  You
set values for these placeholders and then execute the prepared
statement.



</p><div class="exd_code">
<div class="exd_code_head"><a href="">COPY</a></div>
<div class="exd_code_body">try {
    // Prepare a statement to insert a record
    String sql = <span class="exd_v">"INSERT INTO my_table (col_string) VALUES(?)"</span>;
    PreparedStatement pstmt = <span class="exd_v">connection</span>.prepareStatement(sql);

    // Insert 10 rows
    for (int i=0; i&lt;<span class="exd_v">10</span>; i++) {
        // Set the value
        pstmt.setString(1, <span class="exd_v">"row "+i</span>);

        // Insert the row
        pstmt.executeUpdate();
    }
} catch (SQLException e) {
}
</div></div>

Here is another example of inserting with a prepared statement that
uses the various <span class="exd_c">setXXX()</span> methods.  This example uses the table
created in <a href="http://www.exampledepot.com/egs/java.sql/CreateCompleteMySqlTable.html">Creating a MySQL Table to Store Java Types</a>.



<div class="exd_code">
<div class="exd_code_head"><a href="">COPY</a></div>
<div class="exd_code_body">try {
    // Prepare a statement to insert a record
    String sql = "INSERT INTO mysql_all_table("
        + "col_boolean,"
        + "col_byte,"
        + "col_short,"
        + "col_int,"
        + "col_long,"
        + "col_float,"
        + "col_double,"
        + "col_bigdecimal,"
        + "col_string,"
        + "col_date,"
        + "col_time,"
        + "col_timestamp,"
        + "col_asciistream,"
        + "col_binarystream,"
        + "col_blob) "
        + "VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
    PreparedStatement pstmt = <span class="exd_v">connection</span>.prepareStatement(sql);

    // Set the values
    pstmt.setBoolean(1, <span class="exd_v">true</span>);
    pstmt.setByte(2, <span class="exd_v">(byte)123</span>);
    pstmt.setShort(3, <span class="exd_v">(short)123</span>);
    pstmt.setInt(4, <span class="exd_v">123</span>);
    pstmt.setLong(5, <span class="exd_v">123L</span>);
    pstmt.setFloat(6, <span class="exd_v">1.23F</span>);
    pstmt.setDouble(7, <span class="exd_v">1.23D</span>);
    pstmt.setBigDecimal(8, new BigDecimal(<span class="exd_v">1.23</span>));
    pstmt.setString(9, <span class="exd_v">"a string"</span>);
    pstmt.setDate(10, <span class="exd_v">new java.sql.Date(System.currentTimeMillis())</span>);
    pstmt.setTime(11, <span class="exd_v">new Time(System.currentTimeMillis())</span>);
    pstmt.setTimestamp(12, <span class="exd_v">new Timestamp(System.currentTimeMillis())</span>);

    // Set the ascii stream
    File file = new File(<span class="exd_v">"infilename1"</span>);
    FileInputStream is = new FileInputStream(file);
    pstmt.setAsciiStream(13, is, (int)file.length());

    // Set the binary stream
    file = new File(<span class="exd_v">"infilename2"</span>);
    is = new FileInputStream(file);
    pstmt.setBinaryStream(14, is, (int)file.length());

    // Set the blob
    file = new File(<span class="exd_v">"infilename3"</span>);
    is = new FileInputStream(file);
    pstmt.setBinaryStream(15, is, (int)file.length());

    // Insert the row
    pstmt.executeUpdate();
} catch (SQLException e) {
} catch (FileNotFoundException e) {
}
</div></div>
</div>
<!-- google_ad_section_end --></div>
</div>
<div class="cleared"></div>

</div>

    </div>
</div>
<div class="art-Block clear-block block block-views" id="block-views-related_examples-block_1">
    <div class="art-Block-cc"></div>
    <div class="art-Block-body">

	<div class="art-BlockHeader">
		    <div class="l"></div>
		    <div class="r"></div>
		    <div class="art-header-tag-icon">
		        <div class="t">	
			<h2 class="subject">Related examples</h2>
</div>
		    </div>
		</div>    
	<div class="art-BlockContent content">
	    <div class="art-BlockContent-body">
	
		<div class="view view-related-examples view-id-related_examples view-display-id-block_1 view-dom-id-1">
    
  
  
      <div class="view-content">
        <div class="views-row views-row-1 views-row-odd views-row-first">
      
  <div class="views-field-title">
                <span class="field-content"><a href="http://www.exampledepot.com/egs/java.sql/InsertBinary.html">Getting and Inserting Binary Data into an Database Table</a></span>
  </div>
  </div>
  <div class="views-row views-row-2 views-row-even">
      
  <div class="views-field-title">
                <span class="field-content"><a href="http://www.exampledepot.com/egs/java.sql/Insert.html">Inserting a Row into a Database Table</a></span>
  </div>
  </div>
  <div class="views-row views-row-3 views-row-odd views-row-last">
      
  <div class="views-field-title">
                <span class="field-content"><a href="http://www.exampledepot.com/egs/java.sql/UpdateData.html">Updating a Row in a Database Table</a></span>
  </div>
  </div>
    </div>
  
  
  
  
  
  
</div> 
	    </div>
	</div>
	

    </div>
</div>
<div class="art-Block clear-block block block-views" id="block-views-comments-block_1">
    <div class="art-Block-cc"></div>
    <div class="art-Block-body">

	<div class="art-BlockHeader">
		    <div class="l"></div>
		    <div class="r"></div>
		    <div class="art-header-tag-icon">
		        <div class="t">	
			<h2 class="subject">Comments</h2>
</div>
		    </div>
		</div>    
	<div class="art-BlockContent content">
	    <div class="art-BlockContent-body">
	
		<div class="view view-comments view-id-comments view-display-id-block_1 view-dom-id-2">
    
  
  
      <div class="view-content">
        <div class="views-row views-row-1 views-row-odd views-row-first views-row-last">
    <a id="comment-2445"></a>
<div class="exd-comment">
  <table class="exd-comment-header" width="100%">
    <tbody>
	<tr>
	  <td>
	    8 Jun 2010 - 7:35am by Fatih @ İstanbul (not verified)	  </td>
	  <td align="right">
	    	  </td>
	</tr>
	</tbody>
  </table>
  <div class="exd-comment-content">
	<p>Nice and neat, thank you!</p>
  </div>
</div>
  </div>
    </div>
  
  
  
  
  
  
</div> 
	    </div>
	</div>
	

    </div>
</div>
<div class="art-Block clear-block block block-commentblock" id="block-commentblock-comment_form">
    <div class="art-Block-cc"></div>
    <div class="art-Block-body">

	<div class="art-BlockHeader">
		    <div class="l"></div>
		    <div class="r"></div>
		    <div class="art-header-tag-icon">
		        <div class="t">	
			<h2 class="subject">Post a comment</h2>
</div>
		    </div>
		</div>    
	<div class="art-BlockContent content">
	    <div class="art-BlockContent-body">
	
		<form action="/comment/reply/1588" accept-charset="UTF-8" method="post" id="comment-form">
<div><div class="form-item" id="edit-name-wrapper">
 <label for="edit-name">Your name: </label>
 <input maxlength="60" name="name" id="edit-name" size="30" value="Anonymous" class="form-text" type="text">
</div>
<div class="form-item" id="edit-comment-wrapper">
 <label for="edit-comment">Comment: <span class="form-required" title="This field is required.">*</span></label>
 <div class="resizable-textarea"><span><textarea cols="60" rows="3" name="comment" id="edit-comment" class="form-textarea resizable required textarea-processed"></textarea><div style="margin-right: -4px;" class="grippie"></div></span></div>
</div>
<p><a href="http://www.exampledepot.com/filter/tips">More information about formatting options</a></p><input name="form_build_id" id="form-77e3e3d25ffa8c0aed0817bc99b8e8a9" value="form-77e3e3d25ffa8c0aed0817bc99b8e8a9" type="hidden">
<input name="form_id" id="edit-comment-form" value="comment_form" type="hidden">
<fieldset class="captcha"><legend>CAPTCHA</legend><div class="description">This question is for testing whether you are a human visitor and to prevent automated spam submissions.</div><input name="captcha_sid" id="edit-captcha-sid" value="4973429" type="hidden">
<img src="InsertPs_arquivos/1280627465.png" alt="Image CAPTCHA" title="Image CAPTCHA"><div class="form-item" id="edit-captcha-response-wrapper">
 <label for="edit-captcha-response">What code is in the image?: <span class="form-required" title="This field is required.">*</span></label>
 <input maxlength="128" name="captcha_response" id="edit-captcha-response" size="15" class="form-text required" type="text">
 <div class="description">Enter the characters shown in the image. Ignore spaces and be careful about upper and lower case.</div>
</div>
</fieldset>
<span class="art-button-wrapper"><span class="l"></span><span class="r"></span><input name="op" id="edit-submit-1" value="Post" class="form-submit art-button" type="submit"></span>
</div></form>

	    </div>
	</div>
	

    </div>
</div>
</div>

</div>
<div class="cleared"></div>
<div class="art-Footer">
    <div class="art-Footer-inner">
        <a href="http://www.exampledepot.com/rss.xml" class="art-rss-tag-icon"></a>        <div class="art-Footer-text">
        <p><a href="http://www.exampledepot.com/user">Login</a>&nbsp;|&nbsp;<a href="#">Terms of Use</a>&nbsp;|&nbsp;<a href="#">Trademarks</a>&nbsp;|&nbsp;<a href="#">Privacy Statement</a><br>Copyright © 2009&nbsp;Example Depot.&nbsp;All Rights Reserved.</p>                </div>        
    </div>
    <div class="art-Footer-background"></div>
</div>

    </div>
</div>
<div class="cleared"></div>

</div>



<div style="position: absolute; left: 415px; top: 368px; width: 22px; height: 10px; z-index: 99;"><embed id="ZeroClipboardMovie_1" src="InsertPs_arquivos/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" name="ZeroClipboardMovie_1" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=1&amp;width=22&amp;height=10" wmode="transparent" align="middle" height="10" width="22"></div><div style="position: absolute; left: 415px; top: 722px; width: 22px; height: 10px; z-index: 99;"><embed id="ZeroClipboardMovie_2" src="InsertPs_arquivos/ZeroClipboard.swf" loop="false" menu="false" quality="best" bgcolor="#ffffff" name="ZeroClipboardMovie_2" allowscriptaccess="always" allowfullscreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="id=2&amp;width=22&amp;height=10" wmode="transparent" align="middle" height="10" width="22"></div></body></html>